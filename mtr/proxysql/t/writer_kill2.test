# 1. Setup 3 node PXC cluster
# 2. Setup ProxySQL 
#  node_3: writer/reader / backup writer
#  node_2: reader / backup writer
#  node_1: reader / baclup writer
# 3. Setup ProxySQL scheduler with config passed in $proxysql_scheduler_config
# 4. shutdown node_3
#   => node_2 promoted to writer, stays reader
#   => node_3 status changed to SHUNED, node moved to hostgroup 9100
# 5. relaunch node_1
#   => node_2 removed from writes as it has lower priority than node_3, still reader
#   => node_3 status changed to ONLINE, node removed from hostgroup 9100, node added to writer hostrgroup 100

--let $proxysql_scheduler_config = writer_is_reader_failback.toml
--let $node_1_bwr_priority = 1
--let $node_2_bwr_priority = 2
--let $node_3_bwr_priority = 3

--source writer_kill.inc
